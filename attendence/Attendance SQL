/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 13.0 		*/
/*  Created On : 24-úno-2020 16:48:05 				*/
/*  DBMS       : Oracle 						*/
/* ---------------------------------------------------- */

/* Drop Tables */

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Actions CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Addresses CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Attandees CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   AttandeesTrainings CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Companies CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Contactinfo CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Hall CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Persons CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Role CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Sponsors CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   SponsorsHall CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Trainings CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   Users CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

begin
	EXECUTE IMMEDIATE 'DROP TABLE   UsersActions CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

/* Create Tables */

CREATE TABLE  Actions
(
	Date DATE NOT NULL,
	Description VARCHAR(255) NULL,
	Type NUMBER(1) NOT NULL,
	ActionsID NUMBER(8) NOT NULL,
	AddressesID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Addresses
(
	City VARCHAR(50) NULL,
	State VARCHAR(50) NULL,
	Street VARCHAR(50) NULL,
	Zip VARCHAR(6) NULL,
	AddressesID NUMBER(8) NOT NULL,
	HallID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Attandees
(
	Ispaid NUMBER(1) NOT NULL,
	Pinumber VARCHAR(12) NOT NULL,
	Sex NUMBER(1) NOT NULL,
	AttandeesID NUMBER(8) NOT NULL,
	PersonsID NUMBER(8) NULL
)
;

CREATE TABLE  AttandeesTrainings
(
	TrainingsID NUMBER(8) NOT NULL,
	AttandeesID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Companies
(
	Name VARCHAR(50) NOT NULL,
	CompaniesID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Contactinfo
(
	Email VARCHAR(50) NOT NULL,
	Ismain NUMBER(1) NOT NULL,
	Phone VARCHAR(20) NOT NULL,
	ContactinfoID NUMBER(8) NOT NULL,
	PersonsID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Hall
(
	Name VARCHAR(50) NOT NULL,
	HallID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Persons
(
	Dateofbirth DATE NOT NULL,
	Dateofcome DATE NOT NULL,
	Firstname VARCHAR(20) NOT NULL,
	Isactive NUMBER(1) NOT NULL,
	Lastname VARCHAR(50) NOT NULL,
	PersonsID NUMBER(8) NOT NULL,
	AddressesID NUMBER(8) NOT NULL,
	AttandeesID NUMBER(8) NULL,
	RoleID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Role
(
	Description VARCHAR(255) NULL,
	Name VARCHAR(50) NULL,
	RoleID NUMBER(8) NOT NULL
)
;

CREATE TABLE  Sponsors
(
	Name VARCHAR(50) NOT NULL,
	SponsorsID NUMBER(8) NOT NULL
)
;

CREATE TABLE  SponsorsHall
(
	HallID NUMBER(8) NULL,
	SponsorsID NUMBER(8) NULL
)
;

CREATE TABLE  Trainings
(
	Endtime TIMESTAMP(6) NOT NULL,
	Starttime TIMESTAMP(6) NOT NULL,
	Type NUMBER(1) NOT NULL,
	TrainingsID NUMBER(8) NOT NULL,
	HallID NUMBER(8) NOT NULL,
	UsersID NUMBER(8) NULL
)
;

CREATE TABLE  Users
(
	Username VARCHAR(20) NOT NULL,
	UsersID NUMBER(8) NOT NULL,
	CompaniesID NUMBER(8) NOT NULL,
	PersonsID NUMBER(8) NULL
)
;

CREATE TABLE  UsersActions
(
	ActionsID NUMBER(8) NULL,
	UsersID NUMBER(8) NULL
)
;

/* Create Primary Keys, Indexes, Uniques, Checks, Triggers */

ALTER TABLE  Actions 
 ADD CONSTRAINT PK_Actions
	PRIMARY KEY (ActionsID) 
 USING INDEX
;

ALTER TABLE  Addresses 
 ADD CONSTRAINT PK_Addresses
	PRIMARY KEY (AddressesID) 
 USING INDEX
;

ALTER TABLE  Attandees 
 ADD CONSTRAINT PK_Attandees
	PRIMARY KEY (AttandeesID) 
 USING INDEX
;

ALTER TABLE  Companies 
 ADD CONSTRAINT PK_Companies
	PRIMARY KEY (CompaniesID) 
 USING INDEX
;

ALTER TABLE  Contactinfo 
 ADD CONSTRAINT PK_Contactinfo
	PRIMARY KEY (ContactinfoID) 
 USING INDEX
;

ALTER TABLE  Hall 
 ADD CONSTRAINT PK_Hall
	PRIMARY KEY (HallID) 
 USING INDEX
;

ALTER TABLE  Persons 
 ADD CONSTRAINT PK_Persons
	PRIMARY KEY (PersonsID) 
 USING INDEX
;

CREATE INDEX FK_PERONS_USER   
 ON  Persons () 
;

ALTER TABLE  Role 
 ADD CONSTRAINT PK_Role
	PRIMARY KEY (RoleID) 
 USING INDEX
;

ALTER TABLE  Sponsors 
 ADD CONSTRAINT PK_Sponsors
	PRIMARY KEY (SponsorsID) 
 USING INDEX
;

ALTER TABLE  Trainings 
 ADD CONSTRAINT PK_Trainings
	PRIMARY KEY (TrainingsID) 
 USING INDEX
;

ALTER TABLE  Users 
 ADD CONSTRAINT PK_Users
	PRIMARY KEY (UsersID) 
 USING INDEX
;

/* Create Foreign Key Constraints */

ALTER TABLE  Actions 
 ADD CONSTRAINT FK_Actions_Addresses
	FOREIGN KEY (AddressesID) REFERENCES  Addresses (AddressesID)
;

ALTER TABLE  Addresses 
 ADD CONSTRAINT FK_Addresses_Hall
	FOREIGN KEY (HallID) REFERENCES  Hall (HallID)
;

ALTER TABLE  Attandees 
 ADD CONSTRAINT FK_Attandees_Persons
	FOREIGN KEY (PersonsID) REFERENCES  Persons (PersonsID)
;

ALTER TABLE  AttandeesTrainings 
 ADD CONSTRAINT FK_AttandeesTrainings_Trainings
	FOREIGN KEY (TrainingsID) REFERENCES  Trainings (TrainingsID)
;

ALTER TABLE  AttandeesTrainings 
 ADD CONSTRAINT FK_AttandeesTrainings_Attandees
	FOREIGN KEY (AttandeesID) REFERENCES  Attandees (AttandeesID)
;

ALTER TABLE  Contactinfo 
 ADD CONSTRAINT FK_Contactinfo_Persons
	FOREIGN KEY (PersonsID) REFERENCES  Persons (PersonsID)
;

ALTER TABLE  Persons 
 ADD CONSTRAINT FK_Persons_Addresses
	FOREIGN KEY (AddressesID) REFERENCES  Addresses (AddressesID)
;

ALTER TABLE  Persons 
 ADD CONSTRAINT FK_Persons_Role
	FOREIGN KEY (RoleID) REFERENCES  Role (RoleID)
;

ALTER TABLE  SponsorsHall 
 ADD CONSTRAINT FK_SponsorsHall_Hall
	FOREIGN KEY (HallID) REFERENCES  Hall (HallID)
;

ALTER TABLE  SponsorsHall 
 ADD CONSTRAINT FK_SponsorsHall_Sponsors
	FOREIGN KEY (SponsorsID) REFERENCES  Sponsors (SponsorsID)
;

ALTER TABLE  Trainings 
 ADD CONSTRAINT FK_Trainings_Hall
	FOREIGN KEY (HallID) REFERENCES  Hall (HallID)
;

ALTER TABLE  Trainings 
 ADD CONSTRAINT FK_Trainings_Users
	FOREIGN KEY (UsersID) REFERENCES  Users (UsersID)
;

ALTER TABLE  Users 
 ADD CONSTRAINT FK_Users_Companies
	FOREIGN KEY (CompaniesID) REFERENCES  Companies (CompaniesID)
;

ALTER TABLE  UsersActions 
 ADD CONSTRAINT FK_UsersActions_Actions
	FOREIGN KEY (ActionsID) REFERENCES  Actions (ActionsID)
;

ALTER TABLE  UsersActions 
 ADD CONSTRAINT FK_UsersActions_Users
	FOREIGN KEY (UsersID) REFERENCES  Users (UsersID)
;
